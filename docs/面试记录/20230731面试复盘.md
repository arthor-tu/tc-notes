# 20230731面试复盘

## Vue中的虚拟dom

面试官：

- Vue中的虚拟dom是什么
- 为什么要使用虚拟dom

回顾：

- 基本概念：Virtual DOM 实际上就是以JavaScript对象（VNode ）为基础形成一棵树，对真实DOM的一层抽象。Vue最终的工作就是通过这棵树批量生成真实的DOM节，可以说两者存在一层映射关系。
- 作用：
  - 提供与真实DOM节点所对应的虚拟节点vnode
  - 将虚拟节点vnode和旧虚拟节点oldVnode进行对比（diff算法），然后更新视图
- 为什么要使用虚拟dom
  - vdom是为了减轻性能压力。dom是昂贵的，昂贵的一方面在dom本身的重量，dom节点在js里的描述是个非常复杂属性很多原型很长的超级对象，另一方面是浏览器渲染进程和js进程是独立分离的，操作dom时的通信和浏览器本身需要重绘的时耗都是很高的。所以大家机智的搞了个轻量的vdom去模拟dom，vdom每个节点都只挂载js操作的必要属性，每次组件update时都先操作vdom，通过vdom的比对，得到一个真实dom的需要操作的集合。整个机制是在JavaScript层面计算，在完成之前并不会操作DOM，等数据稳定之后再实现精准的修改。

## diff算法

- 基本原理
  - diff算法的的基本原理是比较新旧虚拟dom之间的差异，然后只更新需要更新的部分。在比较过程中，diif算法会遍历新旧虚拟dom的节点，然后根据节点的类型和属性来判断节点是否相同。如果节点相同，则比较他们的字节的；如果节点不同，则直接替换节点。
- Vue2.0中，diff算法的优化策略
  - **同级比较**：diff算法会优先比较同级节点，而不是跨级比较。在同层节点中采用了**「双端比较的算法」**，过程为：oldCh和newCh各有两个头尾的变量StartIdx和EndIdx，它们的2个变量相互比较，一共有4种比较方式。如果4种比较都没匹配，如果设置了key，就会用key进行比较，在比较的过程中，变量会往中间靠，一旦StartIdx>EndIdx表明oldCh和newCh至少有一个已经遍历完了，就会结束比较；
    - **组件的Type**
    - **key值比较**：diff算法会根据节点的key值来判断节点是否相同，来决定是否需要进行替换。
    - updateChildren 对比顺序：
      - 头和头比
      - 尾和尾比
      - 头和尾比
      - 尾和头比
都没有命中的对比
  - **移动节点**：diff算法会尽可能地复用已有的节点，而不是直接创建新的节点。
  - 对触发了getter/setter 的组件进行diff，精准减少diff范围


- Vue3.0中的diff
  - diff痛点
    - vue2.x中的虚拟dom是进行「**全量的对比**」，在运行时会对所有节点生成一个虚拟节点树，当页面数据发生变更，会遍历判断virtual dom所有节点（包括一些不会变化的节点）有没有发生变化；虽然说diff算法确实减少了多DOM节点的直接操作，但是这个「**减少是有成本的**」，如果是复杂的大型项目，必然存在很复杂的父子关系的VNode,「**而Vue2.x的diff算法，会不断地递归调用 patchVNode，不断堆叠而成的几毫秒，最终就会造成 VNode 更新缓慢**」。
  - 优化点
    - **添加静态标记**：Vue3.0对于不参与更新的元素，做静态标记并提示，只会被创建一次，在渲染时直接复用。
    - **事件缓存**：将事件缓存，可以理解为变成静态的了
    - **静态提升**：
      - 在 Vue2 里每当触发更新的时候，不管元素是否参与更新，每次都会全部重新创建。
      - 而在 Vue3 中会把这个不参与更新的元素保存起来，只创建一次，之后在每次渲染的时候不停地复用，比如上面例子中的静态的创建一次保存起来
    - 使用最长递增子序列优化了对比流程：
      - patchKeyedChildren 比对顺序
        - 头和头比
        - 尾和尾比
        - 基于最长递增子序列进行移动/添加/删除

## Webpack

面试官：

- 什么是Webpack？
- 你知道Vite吗

回顾：

## CSS3

## ES6有哪些新特性

## 闭包

## axios的封装和原理

## 了解Nodejs吗

## 组件通信

## 深拷贝和浅拷贝

## Promise原理

- Promise是怎么解决同步异步问题的

**补充**

## typeof 与 intanceof

- **typeof**
  - typeof是一个运算符，其有两种使用方式：（1）typeof(表达式)；（2）typeof 变量名；返回值是一个字符串，用来说明变量的数据类型；所以可以用此来判断number, string, object, boolean, function, undefined, symbol 这七种类型.
  - 缺陷：对于对象、数组、null 返回的值是 object。
- **intanceof**
  - instanceof运算符用于检测构造函数的 prototype属性是否出现在某个实例对象的原型链上,返回值为布尔值，用于指示一个变量是否属于某个对象的实例。
  - 缺陷：



  参考文章
  - CSDN-[Vue3diff算法原理与优化](https://blog.csdn.net/frontend_frank/article/details/114297890)